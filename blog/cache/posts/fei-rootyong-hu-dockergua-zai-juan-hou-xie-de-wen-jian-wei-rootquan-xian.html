<h3>description:</h3>
<p>执行挂载操作的用户的uid和gid会映射到docker里运行.</p>
<p><code>Host uid == container uid</code></p>
<p><code>Host gid == container gid</code></p>
<p>如果Docker里的程序创建了其他用户,那写出来的文件,宿主机
可能没有对应的用户,注意只是根据uid和gid来判断,即使有
相同的uid和gid显示的用户名可能还是不同的.</p>
<pre class="code literal-block"><span></span><span class="k">SELECT</span> <span class="n">H</span><span class="p">.</span><span class="n">uid</span><span class="p">,</span> <span class="n">H</span><span class="p">.</span><span class="n">gid</span><span class="p">,</span> <span class="n">H</span><span class="p">.</span><span class="n">uname</span><span class="p">,</span><span class="n">H</span><span class="p">.</span><span class="n">gname</span> <span class="k">FROM</span> <span class="k">Host</span> <span class="n">H</span> <span class="k">RIGHT</span> <span class="k">JOIN</span> <span class="p">(</span>
   <span class="k">SELECT</span> <span class="n">uid</span><span class="p">,</span> <span class="n">gid</span> <span class="k">FROM</span> <span class="n">Container</span>
<span class="p">)</span> <span class="k">C</span> <span class="k">ON</span> <span class="n">H</span><span class="p">.</span><span class="n">uid</span> <span class="o">=</span> <span class="k">C</span><span class="p">.</span><span class="n">uid</span> <span class="k">AND</span> <span class="n">H</span><span class="p">.</span><span class="n">gid</span> <span class="o">=</span> <span class="k">C</span><span class="p">.</span><span class="n">gid</span>
</pre>


<h3>Solutions:</h3>
<pre class="code literal-block"><span></span><span class="l l-Scalar l-Scalar-Plain">docker run --user $(id -u):$(id -g) other_options</span>
</pre>


<p>注意如果环境变量没有设置<code>$UID</code>和<code>$GID</code>,</p>
<pre class="code literal-block"><span></span>WARNING: The UID variable is not set. Defaulting to a blank string.
WARNING: The GID variable is not set. Defaulting to a blank string.
</pre>


<p>使用如下命令执行</p>
<p><code>UID=$(id -u) GID=$(id -g) docker-compose</code></p>
<pre class="code literal-block"><span></span>version: &#39;3&#39;
services:
  db:
    image: image_name
    user: <span class="cp">${</span><span class="n">UID</span><span class="cp">}</span>:<span class="cp">${</span><span class="n">GID</span><span class="cp">}</span>
</pre>